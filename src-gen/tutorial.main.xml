<?xml version="1.0" encoding="UTF-8"?><!--This file was generated by the ALFA Plugin for Eclipse from Axiomatics AB (http://www.axiomatics.com).--><!--Any modification to this file will be lost upon recompilation of the source ALFA file--><xacml3:PolicySet PolicyCombiningAlgId="urn:oasis:names:tc:xacml:1.0:policy-combining-algorithm:first-applicable" PolicySetId="http://axiomatics.com/alfa/identifier/tutorial.Main" Version="1.0" xmlns:xacml3="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17"><xacml3:Description>The Main Policyset</xacml3:Description><xacml3:PolicySetDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicySetDefaults><xacml3:Target/><xacml3:Policy PolicyId="http://axiomatics.com/alfa/identifier/tutorial.Main.tutorialRecords" RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:first-applicable" Version="1.0"><xacml3:Description>Master APS Tutorial policy</xacml3:Description><xacml3:PolicyDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicyDefaults><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match MatchId="urn:oasis:names:tc:xacml:3.0:function:string-equal-ignore-case"><xacml3:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">record</xacml3:AttributeValue><xacml3:AttributeDesignator AttributeId="com.acme.record.objectType" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target><xacml3:Rule Effect="Permit" RuleId="tutorial.Main.tutorialRecords.managersCanView"><xacml3:Description>R1 - A manager can view any records</xacml3:Description><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><xacml3:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">view</xacml3:AttributeValue><xacml3:AttributeDesignator AttributeId="com.acme.action.actionId" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match><xacml3:Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><xacml3:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">manager</xacml3:AttributeValue><xacml3:AttributeDesignator AttributeId="com.acme.user.role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target></xacml3:Rule><xacml3:Rule Effect="Permit" RuleId="tutorial.Main.tutorialRecords.employeeCanViewIfSameDepartment"><xacml3:Description>R2 - An employee can view a record in their own department</xacml3:Description><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><xacml3:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">view</xacml3:AttributeValue><xacml3:AttributeDesignator AttributeId="com.acme.action.actionId" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match><xacml3:Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><xacml3:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">employee</xacml3:AttributeValue><xacml3:AttributeDesignator AttributeId="com.acme.user.role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target><xacml3:Condition><xacml3:Apply FunctionId="urn:oasis:names:tc:xacml:3.0:function:any-of-any"><xacml3:Function FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"/><xacml3:AttributeDesignator AttributeId="com.acme.user.department" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/><xacml3:AttributeDesignator AttributeId="com.acme.record.department" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Apply></xacml3:Condition></xacml3:Rule><xacml3:Rule Effect="Permit" RuleId="tutorial.Main.tutorialRecords.employeeCanEdit"><xacml3:Description>R3 - An employee can edit a record they own, if it is in draft mode</xacml3:Description><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><xacml3:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">edit</xacml3:AttributeValue><xacml3:AttributeDesignator AttributeId="com.acme.action.actionId" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match><xacml3:Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><xacml3:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">employee</xacml3:AttributeValue><xacml3:AttributeDesignator AttributeId="com.acme.user.role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match><xacml3:Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><xacml3:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">draft</xacml3:AttributeValue><xacml3:AttributeDesignator AttributeId="com.acme.record.status" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target></xacml3:Rule><xacml3:Rule Effect="Permit" RuleId="tutorial.Main.tutorialRecords.managerCanPublish"><xacml3:Description>R4 - A manager can publish a record if the record is in final mode
and it belongs to a employee below that manager.</xacml3:Description><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><xacml3:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">publish</xacml3:AttributeValue><xacml3:AttributeDesignator AttributeId="com.acme.action.actionId" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match><xacml3:Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><xacml3:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">manager</xacml3:AttributeValue><xacml3:AttributeDesignator AttributeId="com.acme.user.role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match><xacml3:Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><xacml3:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">final</xacml3:AttributeValue><xacml3:AttributeDesignator AttributeId="com.acme.record.status" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target><xacml3:Condition><xacml3:Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-is-in"><xacml3:Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only"><xacml3:AttributeDesignator AttributeId="com.acme.record.owner" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Apply><xacml3:AttributeDesignator AttributeId="com.acme.user.subordinate" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Apply></xacml3:Condition></xacml3:Rule></xacml3:Policy></xacml3:PolicySet>